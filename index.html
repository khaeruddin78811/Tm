<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>کدنویسی و خروجی</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #f0f0f0;
      transition: background 0.5s;
    }
    .toolbar {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      background: #333;
      padding: 10px;
      color: white;
    }
    .toolbar select, .toolbar button {
      margin: 5px;
      padding: 5px 10px;
      font-size: 14px;
      border-radius: 10px;
      border: none;
    }
    .toolbar button {
      background: #444;
      color: white;
      cursor: pointer;
    }
    .toolbar button:hover {
      background: #666;
    }
    .editor-area, .output-area {
      display: flex;
      flex-direction: column;
      height: 50vh;
    }
    textarea {
      flex: 1;
      padding: 10px;
      font-family: monospace;
      font-size: 14px;
      resize: none;
    }
    iframe {
      flex: 1;
      border: none;
      background: white;
    }
    .dark-mode {
      background: #1e1e1e;
      color: white;
    }
    .dark-mode textarea {
      background: #2e2e2e;
      color: white;
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <div>
      <select id="modeSelect">
        <option value="html">HTML</option>
        <option value="css">CSS</option>
        <option value="js">JS</option>
        <option value="html-css-js">HTML/CSS/JS</option>
      </select>
      <select id="quality">
        <option value="1080">1080p</option>
        <option value="720">720p</option>
        <option value="480">480p</option>
      </select>
    </div>
    <div>
      <button onclick="toggleTheme()">🌓 تم شب/روز</button>
      <button onclick="runCode()">▶️ اجرا</button>
      <button onclick="downloadImage()">📷 عکس</button>
      <button onclick="startRecording()">🎥 ضبط</button>
      <button onclick="stopRecording()">⏹️ توقف ویدیو</button>
    </div>
  </div>  <div class="editor-area">
    <textarea id="htmlCode" placeholder="HTML کد..." style="display:block;"></textarea>
    <textarea id="cssCode" placeholder="CSS کد..." style="display:none;"></textarea>
    <textarea id="jsCode" placeholder="JS کد..." style="display:none;"></textarea>
  </div>  <div class="output-area">
    <iframe id="viewer"></iframe>
  </div>  <script>
    const htmlCode = document.getElementById("htmlCode");
    const cssCode = document.getElementById("cssCode");
    const jsCode = document.getElementById("jsCode");
    const viewer = document.getElementById("viewer");
    const modeSelect = document.getElementById("modeSelect");

    modeSelect.addEventListener("change", () => {
      const mode = modeSelect.value;
      htmlCode.style.display = mode.includes("html") ? "block" : "none";
      cssCode.style.display = mode.includes("css") ? "block" : "none";
      jsCode.style.display = mode.includes("js") ? "block" : "none";
    });

    function runCode() {
      const html = htmlCode.value;
      const css = `<style>${cssCode.value}</style>`;const js = `<script>${jsCode.value}</script>`;
  const output = html + css + js;
  const blob = new Blob([output], { type: 'text/html' });
  viewer.src = URL.createObjectURL(blob);
}

function toggleTheme() {
  document.body.classList.toggle("dark-mode");
}

function downloadImage() {
  html2canvas(viewer.contentWindow.document.body).then(canvas => {
    const link = document.createElement('a');
    link.download = 'output.png';
    link.href = canvas.toDataURL();
    link.click();
  });
}

let mediaRecorder;
let recordedChunks = [];

function startRecording() {
  const stream = viewer.contentWindow.document.body.captureStream();
  mediaRecorder = new MediaRecorder(stream, {
    mimeType: "video/webm;codecs=vp9"
  });
  recordedChunks = [];
  mediaRecorder.ondataavailable = e => recordedChunks.push(e.data);
  mediaRecorder.onstop = () => {
    const blob = new Blob(recordedChunks, { type: "video/webm" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `output_${modeSelect.value}.mp4`;
    a.click();
  };
  mediaRecorder.start();
}

function stopRecording() {
  if (mediaRecorder && mediaRecorder.state === "recording") {
    mediaRecorder.stop();
  }
}

  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>
</html>
